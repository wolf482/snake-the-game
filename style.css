apiVersion: k8s.keycloak.org/v2alpha1
kind: Keycloak
metadata:
  name: rhdh-kcv
  namespace: cti-svcs-orion-177398
spec:
  db:
    url: "jdbc:postgresql://10.19.237.9:1524/rhdh_dev?currentSchema=keycloak&user=app_orion_pgsql_dev&password=a0kmGbe8c0&sslmode=prefer"
    vendor: postgres
  hostname:
    hostname: kcv-cti-svcs-orion-177398.apps.namangtd001d.ecs.dyn.nsroot.net
  ingress:
    enabled: true
    className: openshift-default
    tls: true
    annotations:
      route.openshift.io/termination: "edge"
      # Additional recommended annotations:
      haproxy.router.openshift.io/disable_http2: "true"
  instances: 1
  # Properly formatted extraEnv section:
  extraEnv: |
    - name: KC_PROXY
      value: "edge"
    - name: KC_HOSTNAME_STRICT_HTTPS
      value: "false"
    - name: KC_HTTP_ENABLED
      value: "true"
    - name: KC_HOSTNAME_STRICT_BACKCHANNEL
      value: "false"
    # Required for OpenShift edge termination:
    - name: KC_PROXY_ADDRESS_FORWARDING
      value: "true"
