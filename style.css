Installation Guide: Red Hat Build of Keycloak Operator on OpenShift
Document Version: 1.0
Last Updated: [Current Date]
Target Audience: Platform Team

1. Introduction
This document provides step-by-step instructions for installing the Red Hat Build of Keycloak Operator on an OpenShift Cluster. The Keycloak Operator simplifies the deployment and management of Keycloak instances, enabling seamless integration with OpenShift.

Prerequisites
OpenShift Cluster (v4.x+) with cluster-admin privileges

oc CLI installed and configured

Access to the OpenShift Web Console or CLI

Sufficient resources (CPU, Memory, Storage) for Keycloak deployment

2. Installation Steps
2.1. Create a New Project (Namespace)
Create a dedicated namespace for Keycloak:

sh
oc create namespace keycloak-operator
oc project keycloak-operator
2.2. Install the Keycloak Operator via OperatorHub
Option A: Using OpenShift Web Console
Log in to the OpenShift Web Console as a cluster-admin.

Navigate to Operators â†’ OperatorHub.

Search for "Red Hat build of Keycloak".

Click "Install".

Select:

Installation Mode: A specific namespace (keycloak-operator)

Update Channel: stable (or latest supported version)

Approval Strategy: Automatic (recommended)

Click "Install" and wait for the Operator to be ready.

Option B: Using CLI (OLM Subscription)
sh
cat <<EOF | oc apply -f -
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: keycloak-operator
  namespace: keycloak-operator
spec:
  channel: stable
  installPlanApproval: Automatic
  name: rhsso-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace
EOF
Verify the Operator is running:

sh
oc get pods -n keycloak-operator
Expected Output:

text
NAME                                  READY   STATUS    RESTARTS   AGE
keycloak-operator-<hash>              1/1     Running   0          1m
2.3. Deploy a Keycloak Instance
Option A: Using Web Console
Go to Installed Operators â†’ Red Hat build of Keycloak.

Click "Create Keycloak" (default settings are acceptable).

Adjust resources (CPU/Memory) if needed.

Click "Create".

Option B: Using CLI (Custom Resource Definition - CRD)
sh
cat <<EOF | oc apply -f -
apiVersion: keycloak.org/v2alpha1
kind: Keycloak
metadata:
  name: keycloak
  namespace: keycloak-operator
spec:
  instances: 1
  db:
    vendor: postgres
  http:
    tlsSecret: keycloak-tls-secret  # Optional: If using custom TLS
EOF
Verify Keycloak deployment:

sh
oc get pods -n keycloak-operator
oc get keycloak -n keycloak-operator
2.4. Access Keycloak Admin Console
Get the Keycloak route URL:

sh
oc get route keycloak -n keycloak-operator
Open the URL in a browser.

Default credentials:

Username: admin

Password: Retrieve using:

sh
oc get secret credential-keycloak -n keycloak-operator -o jsonpath='{.data.ADMIN_PASSWORD}' | base64 --decode
3. Post-Installation Configuration
3.1. Enable TLS (Optional)
If using OpenShiftâ€™s default ingress certificate:

sh
oc create route passthrough keycloak --service=keycloak-service --port=https -n keycloak-operator
3.2. Scale Keycloak Instances (High Availability)
Edit the Keycloak CR:

yaml
spec:
  instances: 3  # For HA
3.3. Backup & Restore
Use OpenShiftâ€™s Backup & Restore (OADP) for Keycloak data.

Backup PostgreSQL DB separately if using external storage.

4. Troubleshooting
Common Issues
Issue	Resolution
Operator fails to install	Check OLM logs: oc logs -n openshift-operator-lifecycle-manager <pod>
Keycloak pods in CrashLoopBackOff	Check logs: oc logs <keycloak-pod>
Unable to access Admin Console	Verify route and firewall rules
Logs & Diagnostics
sh
oc logs <keycloak-operator-pod> -n keycloak-operator
oc describe keycloak <keycloak-name> -n keycloak-operator
5. Conclusion
The Red Hat Build of Keycloak Operator is now successfully installed on OpenShift. For advanced configurations (LDAP, custom themes, etc.), refer to the official documentation.

Next Steps:

Configure Identity Providers (OIDC, SAML).

Integrate with OpenShift OAuth for cluster authentication.

Approval:
Platform Team Lead: ___________________
Date: _______________

Revision History:

Version	Date	Changes	Author
1.0	[Date]	Initial Draft	[Your Name]
End of Document

Notes for Platform Team:
Monitor resource usage (oc adm top pods -n keycloak-operator).

Regularly update the Operator via OperatorHub.

Consider network policies for secure access.

Let me know if you need modifications or additional details! ðŸš€
